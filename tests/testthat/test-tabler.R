test_that("tabler() works", {

  # Test baseline pass: simple / type 1 ----------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="simple",
                         tableID="B02001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=FALSE,
                         sort_bygroup=FALSE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable")
  
  #Test baseline pass: nosummary / type 2 ----------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="nosummary",
                         tableID="B02001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=FALSE,
                         sort_bygroup=FALSE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable")
  
  # Test baseline pass: summarizeinc / type 3 ----------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="summarizeinc",
                         tableID="B02001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=FALSE,
                         sort_bygroup=FALSE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable")
  
  # Test baseline pass: summarize / type 4 ----------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="summarize",
                         tableID="B02001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=FALSE,
                         sort_bygroup=FALSE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable")
  
  # Test baseline: filter address, no data-------------------------------------
  expect_s3_class(tabler(data_object=NULL,
                         datatype="acs",
                         dataset="acs5",
                         mode="summarize",
                         tableID="B02001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=FALSE,
                         sort_bygroup=FALSE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress="110 W 2nd Ave, Frankfort, KS 66427",
                         filterRadius=1,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=year,
                         geosObject=NULL,
                         verbose=verbose),"flextable")
  
  
  # Test baseline pass: parameter=sort ------------------------------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="simple",
                         tableID="B01001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=TRUE,
                         sort_bygroup=FALSE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable") 
  
  # Test baseline pass: parameter=sort_bygroup ------------------------------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="simple",
                         tableID="B01001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=TRUE,
                         sort_bygroup=TRUE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable") 
  
  # Test baseline pass: parameter=pctFilter ------------------------------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="simple",
                         tableID="B01001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=FALSE,
                         sort_bygroup=FALSE,
                         pctFilter=0.5,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable") 
  
  # Test baseline pass: parameter= usCompare ------------------------------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="simple",
                         tableID="B01001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=FALSE,
                         sort_bygroup=FALSE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=usCompare,
                         stateCompare=NULL,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable") 
  
  # Test baseline pass: parameter=stateCompare ------------------------------------------------
  expect_s3_class(tabler(data_object=data,
                         datatype="acs",
                         dataset="acs5",
                         mode="summarize",
                         tableID="B01001",
                         variables=NULL,
                         #cols=c("labels","estimate","pct","sub_pct"),
                         dispPerc=TRUE,
                         type=NULL,
                         shorten=NULL,
                         sort=FALSE,
                         sort_bygroup=FALSE,
                         pctFilter=NULL,
                         pdf=FALSE,
                         usCompare=NULL,
                         stateCompare=statesCompare,
                         summaryLevels=1,
                         filterAddress=NULL,
                         filterRadius=NULL,
                         filterSummaryLevels=NULL,
                         state=NULL,
                         county=NULL,
                         tract=NULL,
                         block_group=NULL,
                         geography="tract",
                         year=NULL,
                         geosObject=NULL,
                         verbose=verbose),"flextable") 
  
  # Test error: simple / type 2 ----------------------------
  expect_error(tabler(data_object=data$data$type2data,
                      datatype="acs",
                      dataset="acs5",
                      mode="simple",
                      tableID="B02001",
                      variables=NULL,
                      #cols=c("labels","estimate","pct","sub_pct"),
                      dispPerc=TRUE,
                      type=NULL,
                      shorten=NULL,
                      sort=FALSE,
                      sort_bygroup=FALSE,
                      pctFilter=NULL,
                      pdf=FALSE,
                      usCompare=NULL,
                      stateCompare=NULL,
                      summaryLevels=1,
                      filterAddress=NULL,
                      filterRadius=NULL,
                      filterSummaryLevels=NULL,
                      state=NULL,
                      county=NULL,
                      tract=NULL,
                      block_group=NULL,
                      geography="tract",
                      year=NULL,
                      geosObject=NULL,
                      verbose=verbose))
  
  # Test error: nosummary / type 1 ----------------------------
  expect_error(tabler(data_object=data$data$type1data,
                      datatype="acs",
                      dataset="acs5",
                      mode="nosummary",
                      tableID="B02001",
                      variables=NULL,
                      #cols=c("labels","estimate","pct","sub_pct"),
                      dispPerc=TRUE,
                      type=NULL,
                      shorten=NULL,
                      sort=FALSE,
                      sort_bygroup=FALSE,
                      pctFilter=NULL,
                      pdf=FALSE,
                      usCompare=NULL,
                      stateCompare=NULL,
                      summaryLevels=1,
                      filterAddress=NULL,
                      filterRadius=NULL,
                      filterSummaryLevels=NULL,
                      state=NULL,
                      county=NULL,
                      tract=NULL,
                      block_group=NULL,
                      geography="tract",
                      year=NULL,
                      geosObject=NULL,
                      verbose=verbose))
  
  # Test error: summarize / type 4 ----------------------------
  expect_error(tabler(data_object=data$data$type4data,
                      datatype="acs",
                      dataset="acs5",
                      mode="summarizeinc",
                      tableID="B02001",
                      variables=NULL,
                      #cols=c("labels","estimate","pct","sub_pct"),
                      dispPerc=TRUE,
                      type=NULL,
                      shorten=NULL,
                      sort=FALSE,
                      sort_bygroup=FALSE,
                      pctFilter=NULL,
                      pdf=FALSE,
                      usCompare=NULL,
                      stateCompare=NULL,
                      summaryLevels=1,
                      filterAddress=NULL,
                      filterRadius=NULL,
                      filterSummaryLevels=NULL,
                      state=NULL,
                      county=NULL,
                      tract=NULL,
                      block_group=NULL,
                      geography="tract",
                      year=NULL,
                      geosObject=NULL,
                      verbose=verbose))
  
  # Test error: summarizeinc / type 2 ----------------------------
  expect_error(tabler(data_object=data$data$type2data,
                      datatype="acs",
                      dataset="acs5",
                      mode="summarizeinc",
                      tableID="B02001",
                      variables=NULL,
                      #cols=c("labels","estimate","pct","sub_pct"),
                      dispPerc=TRUE,
                      type=NULL,
                      shorten=NULL,
                      sort=FALSE,
                      sort_bygroup=FALSE,
                      pctFilter=NULL,
                      pdf=FALSE,
                      usCompare=NULL,
                      stateCompare=NULL,
                      summaryLevels=1,
                      filterAddress=NULL,
                      filterRadius=NULL,
                      filterSummaryLevels=NULL,
                      state=NULL,
                      county=NULL,
                      tract=NULL,
                      block_group=NULL,
                      geography="tract",
                      year=NULL,
                      geosObject=NULL,
                      verbose=verbose))
  
  
  # Test error: invalid mode ------------------------------------------------
  expect_error(tabler(data_object=data,
                      datatype="acs",
                      dataset="acs5",
                      mode="womp",
                      tableID=NULL,
                      variables=NULL,
                      #cols=c("labels","estimate","pct","sub_pct"),
                      dispPerc=TRUE,
                      type=NULL,
                      shorten=NULL,
                      sort=FALSE,
                      sort_bygroup=FALSE,
                      pctFilter=NULL,
                      pdf=FALSE,
                      usCompare=NULL,
                      stateCompare=NULL,
                      summaryLevels=1,
                      filterAddress=NULL,
                      filterRadius=NULL,
                      filterSummaryLevels=NULL,
                      state=NULL,
                      county=NULL,
                      tract=NULL,
                      block_group=NULL,
                      geography="tract",
                      year=NULL,
                      geosObject=NULL,
                      verbose=verbose))
  
  # Test error: no tableID ----------------------------
  expect_error(tabler(data_object=multivars,
                      datatype="acs",
                      dataset="acs5",
                      mode="simple",
                      tableID=NULL,
                      variables=NULL,
                      #cols=c("labels","estimate","pct","sub_pct"),
                      dispPerc=TRUE,
                      type=NULL,
                      shorten=NULL,
                      sort=FALSE,
                      sort_bygroup=FALSE,
                      pctFilter=NULL,
                      pdf=FALSE,
                      usCompare=NULL,
                      stateCompare=NULL,
                      summaryLevels=1,
                      filterAddress=NULL,
                      filterRadius=NULL,
                      filterSummaryLevels=NULL,
                      state=NULL,
                      county=NULL,
                      tract=NULL,
                      block_group=NULL,
                      geography="tract",
                      year=NULL,
                      geosObject=NULL,
                      verbose=verbose))  
  
  # Test error: multi tableID w/o specification ----------------------------
  expect_error(tabler(data_object=multivars,
                      datatype="acs",
                      dataset="acs5",
                      mode="nosummary",
                      tableID=NULL,
                      variables=NULL,
                      #cols=c("labels","estimate","pct","sub_pct"),
                      dispPerc=TRUE,
                      type=NULL,
                      shorten=NULL,
                      sort=FALSE,
                      sort_bygroup=FALSE,
                      pctFilter=NULL,
                      pdf=FALSE,
                      usCompare=NULL,
                      stateCompare=NULL,
                      summaryLevels=1,
                      filterAddress=NULL,
                      filterRadius=NULL,
                      filterSummaryLevels=NULL,
                      state=NULL,
                      county=NULL,
                      tract=NULL,
                      block_group=NULL,
                      geography="tract",
                      year=NULL,
                      geosObject=NULL,
                      verbose=verbose))
  
  # Test error: multi tableID w/o specification ----------------------------
  expect_error(tabler(data_object=multivars,
                      datatype="acs",
                      dataset="acs5",
                      mode="nosummary",
                      tableID=NULL,
                      variables=NULL,
                      #cols=c("labels","estimate","pct","sub_pct"),
                      dispPerc=TRUE,
                      type=NULL,
                      shorten=NULL,
                      sort=FALSE,
                      sort_bygroup=FALSE,
                      pctFilter=NULL,
                      pdf=FALSE,
                      usCompare=NULL,
                      stateCompare=NULL,
                      summaryLevels=1,
                      filterAddress=NULL,
                      filterRadius=NULL,
                      filterSummaryLevels=NULL,
                      state=NULL,
                      county=NULL,
                      tract=NULL,
                      block_group=NULL,
                      geography="tract",
                      year=NULL,
                      geosObject=NULL,
                      verbose=verbose))
})
