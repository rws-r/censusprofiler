options(tigris_use_cache=TRUE)

test_that("mapper(): Basic filterAddress call works.", {
  expect_s3_class(mapper(mapDF=NULL,
                         tableID="B02001",
                         variable=2,
                         variableSummary=1,
                         year=2022,
                         geography="tract",
                         filterAddress=address,
                         filterRadius=1,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=NULL,
                         geoidLookup=NULL,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=FALSE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=TRUE,
                         dispWater=TRUE,
                         dispPlaces=TRUE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): Basic state-wide (county) call works",{
  expect_s3_class(mapper(mapDF=NULL,
                         tableID="B02001",
                         variable=2,
                         variableSummary=1,
                         year=2022,
                         geography="county",
                         filterAddress=NULL,
                         filterRadius=NULL,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=17,
                         geoidLookup=NULL,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=FALSE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=TRUE,
                         dispWater=TRUE,
                         dispPlaces=TRUE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): Basic county select call works",{
  expect_s3_class(mapper(mapDF=NULL,
                         tableID="B02001",
                         variable="B02001_002",
                         variableSummary="B02001_001",
                         year=2022,
                         geography="county",
                         filterAddress=NULL,
                         filterRadius=NULL,
                         coords=NULL,
                         tract=NULL,
                         county=043,
                         state=17,
                         geoidLookup=NULL,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=FALSE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=FALSE,
                         dispWater=FALSE,
                         dispPlaces=FALSE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): Basic tracts-only area call works",{
  expect_s3_class(mapper(mapDF=NULL,
                         tableID=NULL,
                         variable=NULL,
                         variableSummary=NULL,
                         year=2022,
                         geography="tract",
                         filterAddress=address,
                         filterRadius=1,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=NULL,
                         geoidLookup=NULL,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=TRUE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=FALSE,
                         dispWater=FALSE,
                         dispPlaces=FALSE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): Basic tracts-only radius call works",{
  expect_s3_class(mapper(mapDF=NULL,
                         tableID=NULL,
                         variable=NULL,
                         variableSummary=NULL,
                         year=2022,
                         geography="tract",
                         filterAddress=address,
                         filterRadius=1,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=NULL,
                         geoidLookup=NULL,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=TRUE,
                         areaOnly=FALSE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=FALSE,
                         dispWater=FALSE,
                         dispPlaces=FALSE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): Basic tracts-only area call works in interactive",{
  expect_s3_class(mapper(mapDF=NULL,
                         tableID=NULL,
                         variable=NULL,
                         variableSummary=NULL,
                         year=2022,
                         geography="tract",
                         filterAddress=address,
                         filterRadius=1,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=NULL,
                         geoidLookup=NULL,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=TRUE,
                         alpha=0.3,
                         interactive=TRUE,
                         geosObject=NULL, 
                         dispRoads=TRUE,
                         dispWater=TRUE,
                         dispPlaces=TRUE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): mapDF call works",{
  expect_s3_class(mapper(mapDF=data,
                         tableID="B02001",
                         variable=2,
                         variableSummary=1,
                         year=2022,
                         geography="tract",
                         filterAddress=address,
                         filterRadius=1,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=NULL,
                         geoidLookup=NULL,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=FALSE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=TRUE,
                         dispWater=TRUE,
                         dispPlaces=TRUE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): geoidLookup call works",{
  expect_s3_class(mapper(mapDF=NULL,
                         tableID=NULL,
                         variable=NULL,
                         variableSummary=NULL,
                         year=2022,
                         geography="tract",
                         filterAddress=NULL,
                         filterRadius=NULL,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=NULL,
                         geoidLookup=geos$geo_tracts[[sample(1:nrow(geos$geo_tracts),1),"GEOID"]],
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=TRUE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=TRUE,
                         dispWater=TRUE,
                         dispPlaces=TRUE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): geoidLookup (state) call works",{
  expect_s3_class(mapper(mapDF=NULL,
                         tableID=NULL,
                         variable=NULL,
                         variableSummary=NULL,
                         year=2022,
                         geography="state",
                         filterAddress=NULL,
                         filterRadius=NULL,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=NULL,
                         geoidLookup=17,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=TRUE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=FALSE,
                         dispWater=FALSE,
                         dispPlaces=FALSE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})

test_that("mapper(): geoidLookup (county) call works",{
  expect_s3_class(mapper(mapDF=NULL,
                         tableID=NULL,
                         variable=NULL,
                         variableSummary=NULL,
                         year=2022,
                         geography="county",
                         filterAddress=NULL,
                         filterRadius=NULL,
                         coords=NULL,
                         tract=NULL,
                         county=NULL,
                         state=NULL,
                         geoidLookup=17043,
                         dispPerc=FALSE,
                         LegendTitle="Census Tracts",
                         MapTitle="Selected Census Tracts",
                         radiusOnly=FALSE,
                         areaOnly=TRUE,
                         alpha=0.3,
                         interactive=FALSE,
                         geosObject=NULL, 
                         dispRoads=FALSE,
                         dispWater=FALSE,
                         dispPlaces=FALSE,
                         dispRails=FALSE,
                         datatype="acs",
                         dataset="acs5",
                         censusVars=NULL,
                         verbose=FALSE,
                         test=FALSE,
                         st=NULL),'tmap')
})
